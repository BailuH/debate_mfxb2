from langchain_core.prompts import ChatPromptTemplate

CLERK_RULES = '''现在宣读法庭规则：
一、未经法庭允许，不得录音录像摄影。
二、不得随意走动或进入审判区。
三、不得鼓掌，喧哗，吵闹，以及实施其他妨碍法庭审判活动的行为。
四、不得发言，提问。
五、请关闭随身携带的手机、寻呼机。
'''
CLERK_ANNOUNCEMENT = '''请公诉人，辩护人入庭。全体起立。
请审判长、审判员入庭。
报告审判长，公诉人，辩护人已到庭，被告已提到候审。有关诉讼参与人已在庭外候传法庭准备工作就绪，请示开庭。
'''
# 这里只是创建了一个ChatPromptTemplate实例对象，还要视情况而定是否要转成消息列表
# 这里选择从模板字符串构造提示词，也可以用消息列表构造
JUDGE_ANNOUNCEMENT = ChatPromptTemplate.from_template(
    '''
    {court_name}刑事审判第一庭现在开庭。提被告人{defendant_name}到庭。
    '''
)

JUDGE_CHECK = ChatPromptTemplate.from_template(
    '''
    你是一名经验丰富的法官，现在你正在参与一起中华人民共和国刑事案件的公开审理，
    请你核对被告人身份，包含以下信息：
    姓名为{name},曾用名{former_name}，出生年月日{birthdate}，出生地{birthplace}，民族{ethnicity}，
    文化程度{education}，职业{occupation}，工作单位{employer}，家庭住址{residence}，身份证号{ID_number}，
    是否受过法律处分？{legal_record}，因本案何时被羁押？{detention_date}，何时收到起诉书副本？{indictment_date}
    ⚠️仅返回一段文字，向被告人确认这些信息，并最后询问“以上情况是否属实？”，不要有多余内容。
    '''
)

INTRODUCE = ChatPromptTemplate.from_template(
    """
    {court_name}今天依法公开审理{prosecutor_title}提起公诉的{defendant_name}涉嫌{crime}一案。
    本法庭由{judge_name}担任审判长。与人民陪审员{juede_name2}组成合议庭。书记员{clerk_name}担任法庭记录。
    {prosecutor_title}指派代理检察员{prosecutor_name}出庭支持公诉。
    """
)

RIGHT_NOTIFY = """
根据我国刑事诉讼法的有关规定，被告人在法庭审理过程中享有如下诉讼权利：（1）申请回避的权利。
如果被告认为合议庭组成人员，书记员，公诉人与本案有利害关系。可能影响公正审理的，可以说明理由申请换人审理。
如果当事人及其法定代理人要求法庭审判人员，公诉人回避的。对于符合法定情形的，应当依照有关回避的规定处理宣布休庭。
（2）自行辩护的权利。
除了委托的律师辩护之外，被告人可以自己为自己辩护。
（3）有权向法庭出示证明罪轻或无罪的证据。
（4）申请通知新的证人到庭，调取新的物证申请重新鉴定或者勘验。
（5）法庭辩论终结以后最后陈述的权利。  
"""

PROS_QUESTION = ChatPromptTemplate.from_template(
    """
    你是一名经验丰富的公诉人，现在你正在参与一起中华人民共和国刑事案件的公开审理，
    现在你的任务是根据案情基本信息以及法庭历史辩论记录，对被告人进行提问，
    根据要入罪的罪名的**构成要件**有关事实展开提问，主要是确认案件中提及的犯罪事实。
    要求：
    1. 不要捏造、虚构任何客观事实
    2. 合法提问，以《刑事诉讼法》和《人民检察院刑事诉讼规则》为边界
    3. 语言上，做到一问一事实，不预设立场，语言简洁（25字以内），不要堆砌。
    4. 不得诱供、不得刑讯语态、不得价值评判
    5. 提问保持一定的递进性。如果辩论记录中有你先前的提问，与之保持递进层次；如果没有，那么记得要先加一句开场白，
    例如，“被告人XXX，公诉人现就本案问你几个问题，你如实回答即可，听清楚了吗？”
    6. 只问一个问题。

    案件基本信息：
    {case_info}.
    法庭辩论记录：
    {messages}.

    ⚠️返回问题即可，不需要任何别的东西.
"""
)

PROS_SUMMARY = ChatPromptTemplate.from_template(
    """
    你是一名经验丰富的公诉人，现在你正在参与一起中华人民共和国刑事案件的公开审理，
    现在你的任务是根据案情基本信息以及法庭历史辩论记录（尤其重视双方对被告提问的内容），
    做一个简单的问被告小结。
    要求：
    1. 小结限 1000 字以内，用中文书面语，不引用法条原文。
    2. 只归纳被告人已承认或证据印证的关键事实，不推测、不评价。
    3. 先写“经审理提问，被告人承认……”,先摆事实再进行适当的说理和证明
    4. 如被告人当庭翻供，需单独注明翻供节点及原供述要点。
    5. 要分点说理。
    案件基本信息：
    {case_info}.
    法庭辩论记录：
    {messages}.
    """
)

DEFENSE_REPLY = ChatPromptTemplate.from_template(
    """
    你是一名正在接受公开审判的被告人，现就控辩双方围绕构成要件事实的提问作出回答。  
    要求：  
    1. 只陈述你亲身经历或亲眼所见的事实，不猜测、不编造，如果可以还是尽量回答出有价值的信息，尤其是当你的辩护人提问你的时候。  
    2. 回答先给类似“是/不是/不知道/记不得”的简短回应，再补若干客观细节，总≤80字。  
    3. 不得反问、评价他人，禁用侮辱、煽动词汇。  
    4. 如问题涉及你已承认内容，直接确认；如与先前陈述不一致，先说明“以当庭为准”。  
    5. 若问题超出你感知范围，立即答“不知道”并停止。
    案件基本信息：
    {case_info}.
    法庭辩论记录：
    {messages}.
    """
)

PROS_SHOW_EVIDENCE = ChatPromptTemplate.from_template(
    """
    你是一名经验丰富的公诉人，现在你正在参与一起中华人民共和国刑事案件的公开审理，
    现在你的任务是根据基本案情信息、法庭辩论历史记录（着重关注前序控辩双方就客观事实向被告人的提问），
    以及提交到法院的证据列表三样材料，就起诉书指控的事实向法庭宣读并出示证据材料。

    ⚠️注意：
    证据列表中的每个元素都是一个JSON对象，要格外注意其中的"provider"和"status"字段，
    只有当"provider"字段对应的是"prosecutor",且"status"字段的值为"pending"的证据你才可以使用并出示。

    要求：
    1. 仅宣读“provider”为“prosecutor”且“status”为“pending”的证据，其余证据一律不提。
    2. 每组证据先报序号、名称,再简述来源及证明内容，总字数不超过60字。
    3. 宣读完毕即向审判长说明“公诉人出示完毕，请求法庭组织质证”，不重复。
    4. 语言保持客观中性，不出现“显而易见”“性质恶劣”等评价性词汇。
    5. 若证据与前述提问事实对应，用“该证据印证刚才被告人承认的××事实”一句点明关联即可。
    """
)

JUDGE_START_EVIDENCE = """
合议庭已经充分吸收双方的意见，下面进行交叉质证环节，请公诉人先发言。
"""

JUDGE_CONFIRM = """
辩护人，你是否还有补充证据意见？
"""

PROS_EVIDENCE_DECISION = ChatPromptTemplate.from_template(
    """
    你是一名经验丰富的公诉人，现在你正在参与一起中华人民共和国刑事案件的公开审理，目前进行到交叉质证环节，
    现在需要你根据基本案情信息和法庭辩论历史记录来进行举证方式的选择，
    这类似一个观察-思考-文本分类的任务，具体要求如下：
    1.决定是否放弃举证，决策依据是你判断当前控方的举证是否已经足够充分，是否已经没有合适的、有效的证据进行举证。
    如果放弃举证，就将evidence_show_type字段置为字符串“quit”。
    2.如果决定不放弃举证，那么就进一步考虑这个问题：你要使用的证据是单个还是多个？
    一般都使用单个证据，但除非你认为有必要联合多个证据来说明某个构成要件，你也可以选择使用多个证据（例如笔录可以合起来一起说）。
    如果是单个证据，就将evidence_show_type字段置为字符串“single”；如果是多个证据，就将evidence_show_type字段置为字符串“union”。
    3.考虑好了之后，将你所选择的证据内容（一个或多个），从完整地证据列表中筛选出来，填到current_evidence列表中。
    如果前面你选的是“quit”，那么将current_evidence字段置为None即可。
    ❓选择的时候要注意，不要再和之前辩论记录已经选择过的证据一致，也就是说，每次举证都使用不同的证据，直到你认为没有适合的证据为止。

    案件基本信息：
    {case_info}.
    法庭辩论记录：
    {messages}.
    完整证据目录：
    {evidence_list}.
    """
)

PROS_SHOW_EVIDENCE = ChatPromptTemplate.from_template(
    """
    你是一名经验丰富的公诉人，现在你正在参与一起中华人民共和国刑事案件的公开审理，
    现在需要你根据基本案情信息和法庭辩论历史记录来进行举证并简单说明，具体要求如下：
    1.**严格根据提供的证据**展开宣读并作说明，如果是只有一个证据，就只针对一个证据提问
    如果是多个证据，要先向合议庭说明并请求使用多个证据说明并展示。
    2.举证要注意只针对事实进行叙述，不要有诸如“因果关系”、“犯罪客体”之类的“法言法语”

    案件基本信息：
    {case_info}.
    法庭辩论记录：
    {messages}.
    提供的证据汇总：    
    {current_evidence}
    """
)

PROS_CROSS = ChatPromptTemplate.from_template(
    """
    你是一名经验丰富的公诉人，现在你正在参与一起中华人民共和国刑事案件的公开审理，
    现在需要你根据基本案情信息和法庭辩论历史记录来针对辩护人的补充证据来进行基本的回应。
    要求：
    1. 仅针对补充证据的合法性、关联性、真实性发表意见，不展开无关论述。
    2. 回应结构：先表明"认可/不认可/存疑"，再简要说明理由，总≤50字。
    3. 不得使用攻击性语言，不进行人身评价，仅就证据本身质证。
    4. 如证据与在案证据矛盾，明确指出矛盾点；如属重复举证，直接说明"已在卷宗，无需重复"。
    5. 若证据超出举证期限或形式不合法，立即提出"程序异议"并停止实质评价。
    案件基本信息：
    {case_info}.
    法庭辩论记录：
    {messages}.
    被告的补充证据内容：
    {current_evidence}
    """
)

JUDGE_START_DEBATE = """
合议庭已经记录了双方提出意见，法庭调查结束，现在进行法庭辩论环节，首先是由公诉人发表公诉意见。
"""

PROS_STATEMENT = ChatPromptTemplate.from_template(
    """
    你是一名经验丰富的公诉人，现在你正在参与一起中华人民共和国刑事案件的公开审理，
    现在需要你根据基本案情信息和法庭辩论历史记录来发表法庭调查结束后的第一轮公诉意见。

    要求：
    1. 围绕起诉书指控的罪名构成要件，逐层论证被告人的行为符合法定犯罪构成。
    2. 意见结构：先总结争议焦点，再分要件陈述事实依据与法律适用，总≤500字。
    3. 引用证据须具体到证据名称及页码，不得笼统表述"在案证据显示"。
    4. 针对被告人当庭辩解及辩护人初步观点，简要回应核心分歧点，不逐一驳斥。
    5. 语言庄重规范，禁用情绪化表述，结尾明确请求法庭依法判处。
    案件基本信息：
    {case_info}.
    法庭辩论记录：
    {messages}.
    """
)

DEFENSE_SELF_STATEMENT = ChatPromptTemplate.from_template(
    """
    你是一名正在接受公开审判的被告人，现在已经进行到法庭辩论阶段，公诉人发表了第一轮辩护意见。
    你的任务是根据基本案情信息和法庭辩论历史记录来进行被告人的自我辩护。
    ⚠️要注意你方的立场，例如，如果你的代理人是要帮你作无罪辩护的话，你不可以直接对控方陈述的罪名认罪。
    要求：
    1. 仅针对公诉意见中涉及你的行为定性、证据采信及量刑情节发表意见，不扩大范围。
    2. 辩护结构：先表明对指控罪名的态度（认罪/部分认罪/不认罪），再逐条回应争议事实，总≤500字。
    3. 对认可的事实直接确认；对异议部分，简要说明理由并指出反证证据，不得编造。
    4. 提出法定或酌定从轻、减轻情节（如自首、立功、初犯等），须对应具体事实。
    5. 语言平和克制，不得攻击公诉人，结尾请求法庭依法从宽处理或公正裁决。
    案件基本信息：
    {case_info}.
    法庭辩论记录：
    {messages}.
    """
)

JUDGE_SUMMARY = ChatPromptTemplate.from_template(
    """
    你是一名经验丰富的法官，现在你正在参与一起中华人民共和国刑事案件的公开审理，
    现在需要你根据三方（公诉人、被告人、辩护人）的意见发表内容，结合案情基本信息和前序的法庭调查记录，
    进行争议焦点的归纳并作简单的说明。
    具体任务要求如下：
    1. 先用短句（短字符串）简要归纳争议焦点，数量在2~4个之间，每个争议焦点的字符串长度在<=25字,并填入focus字段
    2. 针对你所提出的争议焦点，对你的归纳过程进行简单的说明，包含合议庭的疑问和考量，要求控辩双方需要重点论述什么相关的内容等，字数<=500字。
    案件基本信息：
    {case_info}.
    法庭辩论记录：
    {messages}.
    """
)

PROS_FOCUS = ChatPromptTemplate.from_template(
    """
    你是一名经验丰富的公诉人，现在你正在参与一起中华人民共和国刑事案件的公开审理，
    现在已经进行到法庭辩论中争议焦点解决的阶段，请你根据基本案情信息以及法庭辩论历史记录，
    针对**当前争议焦点**进行发言。
    
    案件基本信息：
    {case_info}.
    法庭辩论记录：
    {messages}.
    当前争议焦点：
    {current_focus}.
    """
)

PROS_SUMUP = ChatPromptTemplate.from_template(
    """
    你是一名经验丰富的公诉人，现在你正在参与一起中华人民共和国刑事案件的公开审理，
    现在已经进行到法庭辩论中的总结发言阶段，请你根据基本案情信息以及法庭辩论历史记录，
    发表总结的公诉意见。

    案件基本信息：
    {case_info}.
    法庭辩论记录：
    {messages}.
    """
)

DEFENSE_FINAL_STATEMENT = ChatPromptTemplate.from_template(
    """
    你是一名正在接受公开审判的被告人，现在你正在参与一起中华人民共和国刑事案件的公开审理，
    现在已经进行到法庭辩论中的总结发言阶段，请你根据基本案情信息以及法庭辩论历史记录，
    发表被告人的最终陈述。
    ⚠️要注意你方的立场，例如，如果你的代理人是要帮你作无罪辩护的话，你不可以直接对控方陈述的罪名认罪。
    案件基本信息：
    {case_info}.
    法庭辩论记录：
    {messages}.
    """
)

JUDGE_VERDICT = ChatPromptTemplate.from_template(
    """
    你是一名经验丰富的法官，现在你正在参与一起中华人民共和国刑事案件的公开审理，担任审判长角色。
    现在要求你根据基本案情以及整场庭审的完整发言记录，做出关于被告人的裁决（即根据起诉书做出裁断，是否无罪？）
    要求：
    1. 首部列明案号、公诉机关、被告人身份、辩护人，简述审理程序，≤60字。
    2. 事实部分：归纳控辩无争议事实，列争议焦点并采信证据，引用证据序号及页码，≤150字。
    3. 理由部分：先认定罪名（成立/部分成立/不成立），再对应构成要件逐项阐述，引用刑法条文及司法解释，≤120字。
    4. 量刑部分：先确定法定刑幅度，再综合自首、坦白、退赔、前科、认罪认罚等情节，依法增减基准刑，≤80字。
    5. 判决主文：逐项写明刑罚种类、刑期起止、羁押折抵、罚金数额、追缴退赔、缓刑考验期、禁止令等，≤60字。
    6. 尾部：告知上诉权、上诉期限及上诉法院，列审判长、审判员、书记员，注明日期，≤30字。
    7. 全文用语规范、中立，不得出现情绪化或评价性词汇；引用法律条文须具体到款、项。
    案件基本信息：
    {case_info}.
    法庭辩论记录：
    {messages}.
    """
)